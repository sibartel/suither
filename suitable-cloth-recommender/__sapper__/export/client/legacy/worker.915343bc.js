import{a as t,e as r,f as e,g as o,c as n,b as s,r as i,d as u}from"./createClass.b7fe6e8e.js";var a=Object.prototype.toString;function h(t){return a.call(t).endsWith("Array]")}function c(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!h(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var e=r.fromIndex,o=void 0===e?0:e,n=r.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=t[o],u=o+1;u<s;u++)t[u]>i&&(i=t[u]);return i}function f(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!h(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var e=r.fromIndex,o=void 0===e?0:e,n=r.toIndex,s=void 0===n?t.length:n;if(o<0||o>=t.length||!Number.isInteger(o))throw new Error("fromIndex must be a positive integer smaller than length");if(s<=o||s>t.length||!Number.isInteger(s))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var i=t[o],u=o+1;u<s;u++)t[u]<i&&(i=t[u]);return i}function l(t){var r,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!h(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==e.output){if(!h(e.output))throw new TypeError("output option must be an array if specified");r=e.output}else r=new Array(t.length);var o=f(t),n=c(t);if(o===n)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=e.min,i=void 0===s?e.autoMinMax?o:0:s,u=e.max,a=void 0===u?e.autoMinMax?n:1:u;if(i>=a)throw new RangeError("min option must be smaller than max option");for(var l=(a-i)/(n-o),m=0;m<t.length;m++)r[m]=(t[m]-o)*l+i;return r}var m=" ".repeat(2),v=" ".repeat(4);function w(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=r.maxRows,o=void 0===e?15:e,n=r.maxColumns,s=void 0===n?10:n,i=r.maxNumSize,u=void 0===i?8:i;return"".concat(t.constructor.name," {\n").concat(m,"[\n").concat(v).concat(p(t,o,s,u),"\n").concat(m,"]\n").concat(m,"rows: ").concat(t.rows,"\n").concat(m,"columns: ").concat(t.columns,"\n}")}function p(t,r,e,o){for(var n=t.rows,s=t.columns,i=Math.min(n,r),u=Math.min(s,e),a=[],h=0;h<i;h++){for(var c=[],f=0;f<u;f++)c.push(g(t.get(h,f),o));a.push("".concat(c.join(" ")))}return u!==s&&(a[a.length-1]+=" ... ".concat(s-e," more columns")),i!==n&&a.push("... ".concat(n-r," more rows")),a.join("\n".concat(v))}function g(t,r){var e=String(t);if(e.length<=r)return e.padEnd(r," ");var o=t.toPrecision(r-2);if(o.length<=r)return o;var n=t.toExponential(r-2),s=n.indexOf("e"),i=n.slice(s);return n.slice(0,r-i.length)+i}function y(t,r,e){var o=e?t.rows:t.rows-1;if(r<0||r>o)throw new RangeError("Row index out of range")}function d(t,r,e){var o=e?t.columns:t.columns-1;if(r<0||r>o)throw new RangeError("Column index out of range")}function b(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return r}function M(t,r){if(r.to1DArray&&(r=r.to1DArray()),r.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return r}function k(r,e){if("object"!==t(e))throw new TypeError("unexpected type for row indices");if(e.some((function(t){return t<0||t>=r.rows})))throw new RangeError("row indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function x(r,e){if("object"!==t(e))throw new TypeError("unexpected type for column indices");if(e.some((function(t){return t<0||t>=r.columns})))throw new RangeError("column indices are out of range");return Array.isArray(e)||(e=Array.from(e)),e}function E(t,r,e,o,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(R("startRow",r),R("endRow",e),R("startColumn",o),R("endColumn",n),r>e||o>n||r<0||r>=t.rows||e<0||e>=t.rows||o<0||o>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function S(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=[],o=0;o<t;o++)e.push(r);return e}function R(t,r){if("number"!=typeof r)throw new TypeError("".concat(t," must be a number"))}function _(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}function A(t,r,e){for(var o=t.rows,n=t.columns,s=[],i=0;i<o;i++){for(var u=0,a=0,h=0,c=0;c<n;c++)u+=h=t.get(i,c)-e[i],a+=h*h;r?s.push((a-u*u/n)/(n-1)):s.push((a-u*u/n)/n)}return s}function T(t,r,e){for(var o=t.rows,n=t.columns,s=[],i=0;i<n;i++){for(var u=0,a=0,h=0,c=0;c<o;c++)u+=h=t.get(c,i)-e[i],a+=h*h;r?s.push((a-u*u/o)/(o-1)):s.push((a-u*u/o)/o)}return s}function C(t,r,e){for(var o=t.rows,n=t.columns,s=o*n,i=0,u=0,a=0,h=0;h<o;h++)for(var c=0;c<n;c++)i+=a=t.get(h,c)-e,u+=a*a;return r?(u-i*i/s)/(s-1):(u-i*i/s)/s}function I(t,r){for(var e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)t.set(e,o,t.get(e,o)-r[e])}function N(t,r){for(var e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)t.set(e,o,t.get(e,o)-r[o])}function j(t,r){for(var e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)t.set(e,o,t.get(e,o)-r)}function q(t){for(var r=[],e=0;e<t.rows;e++){for(var o=0,n=0;n<t.columns;n++)o+=Math.pow(t.get(e,n),2)/(t.columns-1);r.push(Math.sqrt(o))}return r}function z(t,r){for(var e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)t.set(e,o,t.get(e,o)/r[e])}function V(t){for(var r=[],e=0;e<t.columns;e++){for(var o=0,n=0;n<t.rows;n++)o+=Math.pow(t.get(n,e),2)/(t.rows-1);r.push(Math.sqrt(o))}return r}function F(t,r){for(var e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)t.set(e,o,t.get(e,o)/r[o])}function P(t){for(var r=t.size-1,e=0,o=0;o<t.columns;o++)for(var n=0;n<t.rows;n++)e+=Math.pow(t.get(n,o),2)/r;return Math.sqrt(e)}function D(t,r){for(var e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)t.set(e,o,t.get(e,o)/r)}function O(t){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,s=e(t);if(r){var i=e(this).constructor;n=Reflect.construct(s,arguments,i)}else n=s.apply(this,arguments);return o(this,n)}}var J=function(){function r(){n(this,r)}return s(r,[{key:"size",get:function(){return this.rows*this.columns}},{key:"apply",value:function(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.call(this,r,e);return this}},{key:"to1DArray",value:function(){for(var t=[],r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.push(this.get(r,e));return t}},{key:"to2DArray",value:function(){for(var t=[],r=0;r<this.rows;r++){t.push([]);for(var e=0;e<this.columns;e++)t[r].push(this.get(r,e))}return t}},{key:"toJSON",value:function(){return this.to2DArray()}},{key:"isRowVector",value:function(){return 1===this.rows}},{key:"isColumnVector",value:function(){return 1===this.columns}},{key:"isVector",value:function(){return 1===this.rows||1===this.columns}},{key:"isSquare",value:function(){return this.rows===this.columns}},{key:"isEmpty",value:function(){return 0===this.rows||0===this.columns}},{key:"isSymmetric",value:function(){if(this.isSquare()){for(var t=0;t<this.rows;t++)for(var r=0;r<=t;r++)if(this.get(t,r)!==this.get(r,t))return!1;return!0}return!1}},{key:"isEchelonForm",value:function(){for(var t=0,r=0,e=-1,o=!0,n=!1;t<this.rows&&o;){for(r=0,n=!1;r<this.columns&&!1===n;)0===this.get(t,r)?r++:1===this.get(t,r)&&r>e?(n=!0,e=r):(o=!1,n=!0);t++}return o}},{key:"isReducedEchelonForm",value:function(){for(var t=0,r=0,e=-1,o=!0,n=!1;t<this.rows&&o;){for(r=0,n=!1;r<this.columns&&!1===n;)0===this.get(t,r)?r++:1===this.get(t,r)&&r>e?(n=!0,e=r):(o=!1,n=!0);for(var s=r+1;s<this.rows;s++)0!==this.get(t,s)&&(o=!1);t++}return o}},{key:"echelonForm",value:function(){for(var t=this.clone(),r=0,e=0;r<t.rows&&e<t.columns;){for(var o=r,n=r;n<t.rows;n++)t.get(n,e)>t.get(o,e)&&(o=n);if(0===t.get(o,e))e++;else{t.swapRows(r,o);for(var s=t.get(r,e),i=e;i<t.columns;i++)t.set(r,i,t.get(r,i)/s);for(var u=r+1;u<t.rows;u++){var a=t.get(u,e)/t.get(r,e);t.set(u,e,0);for(var h=e+1;h<t.columns;h++)t.set(u,h,t.get(u,h)-t.get(r,h)*a)}r++,e++}}return t}},{key:"reducedEchelonForm",value:function(){for(var t=this.echelonForm(),r=t.columns,e=t.rows,o=e-1;o>=0;)if(0===t.maxRow(o))o--;else{for(var n=0,s=!1;n<e&&!1===s;)1===t.get(o,n)?s=!0:n++;for(var i=0;i<o;i++)for(var u=t.get(i,n),a=n;a<r;a++){var h=t.get(i,a)-u*t.get(o,a);t.set(i,a,h)}o--}return t}},{key:"set",value:function(){throw new Error("set method is unimplemented")}},{key:"get",value:function(){throw new Error("get method is unimplemented")}},{key:"repeat",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==t(r))throw new TypeError("options must be an object");var e=r.rows,o=void 0===e?1:e,n=r.columns,s=void 0===n?1:n;if(!Number.isInteger(o)||o<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(s)||s<=0)throw new TypeError("columns must be a positive integer");for(var i=new U(this.rows*o,this.columns*s),u=0;u<o;u++)for(var a=0;a<s;a++)i.setSubMatrix(this,this.rows*u,this.columns*a);return i}},{key:"fill",value:function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,t);return this}},{key:"neg",value:function(){return this.mulS(-1)}},{key:"getRow",value:function(t){y(this,t);for(var r=[],e=0;e<this.columns;e++)r.push(this.get(t,e));return r}},{key:"getRowVector",value:function(t){return U.rowVector(this.getRow(t))}},{key:"setRow",value:function(t,r){y(this,t),r=b(this,r);for(var e=0;e<this.columns;e++)this.set(t,e,r[e]);return this}},{key:"swapRows",value:function(t,r){y(this,t),y(this,r);for(var e=0;e<this.columns;e++){var o=this.get(t,e);this.set(t,e,this.get(r,e)),this.set(r,e,o)}return this}},{key:"getColumn",value:function(t){d(this,t);for(var r=[],e=0;e<this.rows;e++)r.push(this.get(e,t));return r}},{key:"getColumnVector",value:function(t){return U.columnVector(this.getColumn(t))}},{key:"setColumn",value:function(t,r){d(this,t),r=M(this,r);for(var e=0;e<this.rows;e++)this.set(e,t,r[e]);return this}},{key:"swapColumns",value:function(t,r){d(this,t),d(this,r);for(var e=0;e<this.rows;e++){var o=this.get(e,t);this.set(e,t,this.get(e,r)),this.set(e,r,o)}return this}},{key:"addRowVector",value:function(t){t=b(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[e]);return this}},{key:"subRowVector",value:function(t){t=b(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[e]);return this}},{key:"mulRowVector",value:function(t){t=b(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[e]);return this}},{key:"divRowVector",value:function(t){t=b(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[e]);return this}},{key:"addColumnVector",value:function(t){t=M(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t[r]);return this}},{key:"subColumnVector",value:function(t){t=M(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t[r]);return this}},{key:"mulColumnVector",value:function(t){t=M(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t[r]);return this}},{key:"divColumnVector",value:function(t){t=M(this,t);for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t[r]);return this}},{key:"mulRow",value:function(t,r){y(this,t);for(var e=0;e<this.columns;e++)this.set(t,e,this.get(t,e)*r);return this}},{key:"mulColumn",value:function(t,r){d(this,t);for(var e=0;e<this.rows;e++)this.set(e,t,this.get(e,t)*r);return this}},{key:"max",value:function(){if(this.isEmpty())return NaN;for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)>t&&(t=this.get(r,e));return t}},{key:"maxIndex",value:function(){_(this);for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.get(e,o)>t&&(t=this.get(e,o),r[0]=e,r[1]=o);return r}},{key:"min",value:function(){if(this.isEmpty())return NaN;for(var t=this.get(0,0),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.get(r,e)<t&&(t=this.get(r,e));return t}},{key:"minIndex",value:function(){_(this);for(var t=this.get(0,0),r=[0,0],e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.get(e,o)<t&&(t=this.get(e,o),r[0]=e,r[1]=o);return r}},{key:"maxRow",value:function(t){if(y(this,t),this.isEmpty())return NaN;for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)>r&&(r=this.get(t,e));return r}},{key:"maxRowIndex",value:function(t){y(this,t),_(this);for(var r=this.get(t,0),e=[t,0],o=1;o<this.columns;o++)this.get(t,o)>r&&(r=this.get(t,o),e[1]=o);return e}},{key:"minRow",value:function(t){if(y(this,t),this.isEmpty())return NaN;for(var r=this.get(t,0),e=1;e<this.columns;e++)this.get(t,e)<r&&(r=this.get(t,e));return r}},{key:"minRowIndex",value:function(t){y(this,t),_(this);for(var r=this.get(t,0),e=[t,0],o=1;o<this.columns;o++)this.get(t,o)<r&&(r=this.get(t,o),e[1]=o);return e}},{key:"maxColumn",value:function(t){if(d(this,t),this.isEmpty())return NaN;for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)>r&&(r=this.get(e,t));return r}},{key:"maxColumnIndex",value:function(t){d(this,t),_(this);for(var r=this.get(0,t),e=[0,t],o=1;o<this.rows;o++)this.get(o,t)>r&&(r=this.get(o,t),e[0]=o);return e}},{key:"minColumn",value:function(t){if(d(this,t),this.isEmpty())return NaN;for(var r=this.get(0,t),e=1;e<this.rows;e++)this.get(e,t)<r&&(r=this.get(e,t));return r}},{key:"minColumnIndex",value:function(t){d(this,t),_(this);for(var r=this.get(0,t),e=[0,t],o=1;o<this.rows;o++)this.get(o,t)<r&&(r=this.get(o,t),e[0]=o);return e}},{key:"diag",value:function(){for(var t=Math.min(this.rows,this.columns),r=[],e=0;e<t;e++)r.push(this.get(e,e));return r}},{key:"norm",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"frobenius",r=0;if("max"===t)return this.max();if("frobenius"===t){for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)r+=this.get(e,o)*this.get(e,o);return Math.sqrt(r)}throw new RangeError("unknown norm type: ".concat(t))}},{key:"cumulativeSum",value:function(){for(var t=0,r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t+=this.get(r,e),this.set(r,e,t);return this}},{key:"dot",value:function(t){r.isMatrix(t)&&(t=t.to1DArray());var e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");for(var o=0,n=0;n<e.length;n++)o+=e[n]*t[n];return o}},{key:"mmul",value:function(t){t=U.checkMatrix(t);for(var r=this.rows,e=this.columns,o=t.columns,n=new U(r,o),s=new Float64Array(e),i=0;i<o;i++){for(var u=0;u<e;u++)s[u]=t.get(u,i);for(var a=0;a<r;a++){for(var h=0,c=0;c<e;c++)h+=this.get(a,c)*s[c];n.set(a,i,h)}}return n}},{key:"strassen2x2",value:function(t){t=U.checkMatrix(t);var r=new U(2,2),e=this.get(0,0),o=t.get(0,0),n=this.get(0,1),s=t.get(0,1),i=this.get(1,0),u=t.get(1,0),a=this.get(1,1),h=t.get(1,1),c=(e+a)*(o+h),f=(i+a)*o,l=e*(s-h),m=a*(u-o),v=(e+n)*h,w=c+m-v+(n-a)*(u+h),p=l+v,g=f+m,y=c-f+l+(i-e)*(o+s);return r.set(0,0,w),r.set(0,1,p),r.set(1,0,g),r.set(1,1,y),r}},{key:"strassen3x3",value:function(t){t=U.checkMatrix(t);var r=new U(3,3),e=this.get(0,0),o=this.get(0,1),n=this.get(0,2),s=this.get(1,0),i=this.get(1,1),u=this.get(1,2),a=this.get(2,0),h=this.get(2,1),c=this.get(2,2),f=t.get(0,0),l=t.get(0,1),m=t.get(0,2),v=t.get(1,0),w=t.get(1,1),p=t.get(1,2),g=t.get(2,0),y=t.get(2,1),d=t.get(2,2),b=(e-s)*(-l+w),M=(-e+s+i)*(f-l+w),k=(s+i)*(-f+l),x=e*f,E=(-e+a+h)*(f-m+p),S=(-e+a)*(m-p),R=(a+h)*(-f+m),_=(-n+h+c)*(w+g-y),A=(n-c)*(w-y),T=n*g,C=(h+c)*(-g+y),I=(-n+i+u)*(p+g-d),N=(n-u)*(p-d),j=(i+u)*(-g+d),q=x+T+o*v,z=(e+o+n-s-i-h-c)*w+M+k+x+_+T+C,V=x+E+R+(e+o+n-i-u-a-h)*p+T+I+j,F=b+i*(-f+l+v-w-p-g+d)+M+x+T+I+N,P=b+M+k+x+u*y,D=T+I+N+j+s*m,O=x+E+S+h*(-f+m+v-w-p-g+y)+_+A+T,J=_+A+T+C+a*l,B=x+E+S+R+c*d;return r.set(0,0,q),r.set(0,1,z),r.set(0,2,V),r.set(1,0,F),r.set(1,1,P),r.set(1,2,D),r.set(2,0,O),r.set(2,1,J),r.set(2,2,B),r}},{key:"mmulStrassen",value:function(t){t=U.checkMatrix(t);var e=this.clone(),o=e.rows,n=e.columns,s=t.rows,i=t.columns;function u(t,e,o){var n=t.rows,s=t.columns;if(n===e&&s===o)return t;var i=r.zeros(e,o);return i=i.setSubMatrix(t,0,0)}n!==s&&console.warn("Multiplying ".concat(o," x ").concat(n," and ").concat(s," x ").concat(i," matrix: dimensions do not match."));var a=Math.max(o,s),h=Math.max(n,i);return function t(e,o,n,s){if(n<=512||s<=512)return e.mmul(o);n%2==1&&s%2==1?(e=u(e,n+1,s+1),o=u(o,n+1,s+1)):n%2==1?(e=u(e,n+1,s),o=u(o,n+1,s)):s%2==1&&(e=u(e,n,s+1),o=u(o,n,s+1));var i=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),h=e.subMatrix(0,i-1,0,a-1),c=o.subMatrix(0,i-1,0,a-1),f=e.subMatrix(0,i-1,a,e.columns-1),l=o.subMatrix(0,i-1,a,o.columns-1),m=e.subMatrix(i,e.rows-1,0,a-1),v=o.subMatrix(i,o.rows-1,0,a-1),w=e.subMatrix(i,e.rows-1,a,e.columns-1),p=o.subMatrix(i,o.rows-1,a,o.columns-1),g=t(r.add(h,w),r.add(c,p),i,a),y=t(r.add(m,w),c,i,a),d=t(h,r.sub(l,p),i,a),b=t(w,r.sub(v,c),i,a),M=t(r.add(h,f),p,i,a),k=t(r.sub(m,h),r.add(c,l),i,a),x=t(r.sub(f,w),r.add(v,p),i,a),E=r.add(g,b);E.sub(M),E.add(x);var S=r.add(d,M),R=r.add(y,b),_=r.sub(g,y);_.add(d),_.add(k);var A=r.zeros(2*E.rows,2*E.columns);return(A=(A=(A=(A=A.setSubMatrix(E,0,0)).setSubMatrix(S,E.rows,0)).setSubMatrix(R,0,E.columns)).setSubMatrix(_,E.rows,E.columns)).subMatrix(0,n-1,0,s-1)}(e=u(e,a,h),t=u(t,a,h),a,h)}},{key:"scaleRows",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==t(r))throw new TypeError("options must be an object");var e=r.min,o=void 0===e?0:e,n=r.max,s=void 0===n?1:n;if(!Number.isFinite(o))throw new TypeError("min must be a number");if(!Number.isFinite(s))throw new TypeError("max must be a number");if(o>=s)throw new RangeError("min must be smaller than max");for(var i=new U(this.rows,this.columns),u=0;u<this.rows;u++){var a=this.getRow(u);a.length>0&&l(a,{min:o,max:s,output:a}),i.setRow(u,a)}return i}},{key:"scaleColumns",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==t(r))throw new TypeError("options must be an object");var e=r.min,o=void 0===e?0:e,n=r.max,s=void 0===n?1:n;if(!Number.isFinite(o))throw new TypeError("min must be a number");if(!Number.isFinite(s))throw new TypeError("max must be a number");if(o>=s)throw new RangeError("min must be smaller than max");for(var i=new U(this.rows,this.columns),u=0;u<this.columns;u++){var a=this.getColumn(u);a.length&&l(a,{min:o,max:s,output:a}),i.setColumn(u,a)}return i}},{key:"flipRows",value:function(){for(var t=Math.ceil(this.columns/2),r=0;r<this.rows;r++)for(var e=0;e<t;e++){var o=this.get(r,e),n=this.get(r,this.columns-1-e);this.set(r,e,n),this.set(r,this.columns-1-e,o)}return this}},{key:"flipColumns",value:function(){for(var t=Math.ceil(this.rows/2),r=0;r<this.columns;r++)for(var e=0;e<t;e++){var o=this.get(e,r),n=this.get(this.rows-1-e,r);this.set(e,r,n),this.set(this.rows-1-e,r,o)}return this}},{key:"kroneckerProduct",value:function(t){t=U.checkMatrix(t);for(var r=this.rows,e=this.columns,o=t.rows,n=t.columns,s=new U(r*o,e*n),i=0;i<r;i++)for(var u=0;u<e;u++)for(var a=0;a<o;a++)for(var h=0;h<n;h++)s.set(o*i+a,n*u+h,this.get(i,u)*t.get(a,h));return s}},{key:"kroneckerSum",value:function(t){if(t=U.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");var r=this.rows,e=t.rows,o=this.kroneckerProduct(U.eye(e,e)),n=U.eye(r,r).kroneckerProduct(t);return o.add(n)}},{key:"transpose",value:function(){for(var t=new U(this.columns,this.rows),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(e,r,this.get(r,e));return t}},{key:"sortRows",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,r=0;r<this.rows;r++)this.setRow(r,this.getRow(r).sort(t));return this}},{key:"sortColumns",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,r=0;r<this.columns;r++)this.setColumn(r,this.getColumn(r).sort(t));return this}},{key:"subMatrix",value:function(t,r,e,o){E(this,t,r,e,o);for(var n=new U(r-t+1,o-e+1),s=t;s<=r;s++)for(var i=e;i<=o;i++)n.set(s-t,i-e,this.get(s,i));return n}},{key:"subMatrixRow",value:function(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.columns-1),r>e||r<0||r>=this.columns||e<0||e>=this.columns)throw new RangeError("Argument out of range");for(var o=new U(t.length,e-r+1),n=0;n<t.length;n++)for(var s=r;s<=e;s++){if(t[n]<0||t[n]>=this.rows)throw new RangeError("Row index out of range: ".concat(t[n]));o.set(n,s-r,this.get(t[n],s))}return o}},{key:"subMatrixColumn",value:function(t,r,e){if(void 0===r&&(r=0),void 0===e&&(e=this.rows-1),r>e||r<0||r>=this.rows||e<0||e>=this.rows)throw new RangeError("Argument out of range");for(var o=new U(e-r+1,t.length),n=0;n<t.length;n++)for(var s=r;s<=e;s++){if(t[n]<0||t[n]>=this.columns)throw new RangeError("Column index out of range: ".concat(t[n]));o.set(s-r,n,this.get(s,t[n]))}return o}},{key:"setSubMatrix",value:function(t,r,e){if((t=U.checkMatrix(t)).isEmpty())return this;E(this,r,r+t.rows-1,e,e+t.columns-1);for(var o=0;o<t.rows;o++)for(var n=0;n<t.columns;n++)this.set(r+o,e+n,t.get(o,n));return this}},{key:"selection",value:function(t,r){for(var e=function(t,r,e){return{row:k(t,r),column:x(t,e)}}(this,t,r),o=new U(t.length,r.length),n=0;n<e.row.length;n++)for(var s=e.row[n],i=0;i<e.column.length;i++){var u=e.column[i];o.set(n,i,this.get(s,u))}return o}},{key:"trace",value:function(){for(var t=Math.min(this.rows,this.columns),r=0,e=0;e<t;e++)r+=this.get(e,e);return r}},{key:"clone",value:function(){for(var t=new U(this.rows,this.columns),r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)t.set(r,e,this.get(r,e));return t}},{key:"sum",value:function(t){switch(t){case"row":return function(t){for(var r=S(t.rows),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r[e]+=t.get(e,o);return r}(this);case"column":return function(t){for(var r=S(t.columns),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r[o]+=t.get(e,o);return r}(this);case void 0:return function(t){for(var r=0,e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)r+=t.get(e,o);return r}(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"product",value:function(t){switch(t){case"row":return function(t){for(var r=S(t.rows,1),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r[e]*=t.get(e,o);return r}(this);case"column":return function(t){for(var r=S(t.columns,1),e=0;e<t.rows;++e)for(var o=0;o<t.columns;++o)r[o]*=t.get(e,o);return r}(this);case void 0:return function(t){for(var r=1,e=0;e<t.rows;e++)for(var o=0;o<t.columns;o++)r*=t.get(e,o);return r}(this);default:throw new Error("invalid option: ".concat(t))}}},{key:"mean",value:function(t){var r=this.sum(t);switch(t){case"row":for(var e=0;e<this.rows;e++)r[e]/=this.columns;return r;case"column":for(var o=0;o<this.columns;o++)r[o]/=this.rows;return r;case void 0:return r/this.size;default:throw new Error("invalid option: ".concat(t))}}},{key:"variance",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===t(r)&&(e=r,r=void 0),"object"!==t(e))throw new TypeError("options must be an object");var o=e,n=o.unbiased,s=void 0===n||n,i=o.mean,u=void 0===i?this.mean(r):i;if("boolean"!=typeof s)throw new TypeError("unbiased must be a boolean");switch(r){case"row":if(!Array.isArray(u))throw new TypeError("mean must be an array");return A(this,s,u);case"column":if(!Array.isArray(u))throw new TypeError("mean must be an array");return T(this,s,u);case void 0:if("number"!=typeof u)throw new TypeError("mean must be a number");return C(this,s,u);default:throw new Error("invalid option: ".concat(r))}}},{key:"standardDeviation",value:function(r,e){"object"===t(r)&&(e=r,r=void 0);var o=this.variance(r,e);if(void 0===r)return Math.sqrt(o);for(var n=0;n<o.length;n++)o[n]=Math.sqrt(o[n]);return o}},{key:"center",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===t(r)&&(e=r,r=void 0),"object"!==t(e))throw new TypeError("options must be an object");var o=e,n=o.center,s=void 0===n?this.mean(r):n;switch(r){case"row":if(!Array.isArray(s))throw new TypeError("center must be an array");return I(this,s),this;case"column":if(!Array.isArray(s))throw new TypeError("center must be an array");return N(this,s),this;case void 0:if("number"!=typeof s)throw new TypeError("center must be a number");return j(this,s),this;default:throw new Error("invalid option: ".concat(r))}}},{key:"scale",value:function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===t(r)&&(e=r,r=void 0),"object"!==t(e))throw new TypeError("options must be an object");var o=e.scale;switch(r){case"row":if(void 0===o)o=q(this);else if(!Array.isArray(o))throw new TypeError("scale must be an array");return z(this,o),this;case"column":if(void 0===o)o=V(this);else if(!Array.isArray(o))throw new TypeError("scale must be an array");return F(this,o),this;case void 0:if(void 0===o)o=P(this);else if("number"!=typeof o)throw new TypeError("scale must be a number");return D(this,o),this;default:throw new Error("invalid option: ".concat(r))}}},{key:"toString",value:function(t){return w(this,t)}}],[{key:"from1DArray",value:function(t,r,e){if(t*r!==e.length)throw new RangeError("data length does not match given dimensions");for(var o=new U(t,r),n=0;n<t;n++)for(var s=0;s<r;s++)o.set(n,s,e[n*r+s]);return o}},{key:"rowVector",value:function(t){for(var r=new U(1,t.length),e=0;e<t.length;e++)r.set(0,e,t[e]);return r}},{key:"columnVector",value:function(t){for(var r=new U(t.length,1),e=0;e<t.length;e++)r.set(e,0,t[e]);return r}},{key:"zeros",value:function(t,r){return new U(t,r)}},{key:"ones",value:function(t,r){return new U(t,r).fill(1)}},{key:"rand",value:function(r,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==t(o))throw new TypeError("options must be an object");for(var n=o.random,s=void 0===n?Math.random:n,i=new U(r,e),u=0;u<r;u++)for(var a=0;a<e;a++)i.set(u,a,s());return i}},{key:"randInt",value:function(r,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("object"!==t(o))throw new TypeError("options must be an object");var n=o.min,s=void 0===n?0:n,i=o.max,u=void 0===i?1e3:i,a=o.random,h=void 0===a?Math.random:a;if(!Number.isInteger(s))throw new TypeError("min must be an integer");if(!Number.isInteger(u))throw new TypeError("max must be an integer");if(s>=u)throw new RangeError("min must be smaller than max");for(var c=u-s,f=new U(r,e),l=0;l<r;l++)for(var m=0;m<e;m++){var v=s+Math.round(h()*c);f.set(l,m,v)}return f}},{key:"eye",value:function(t,r,e){void 0===r&&(r=t),void 0===e&&(e=1);for(var o=Math.min(t,r),n=this.zeros(t,r),s=0;s<o;s++)n.set(s,s,e);return n}},{key:"diag",value:function(t,r,e){var o=t.length;void 0===r&&(r=o),void 0===e&&(e=r);for(var n=Math.min(o,r,e),s=this.zeros(r,e),i=0;i<n;i++)s.set(i,i,t[i]);return s}},{key:"min",value:function(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,o=t.columns,n=new U(e,o),s=0;s<e;s++)for(var i=0;i<o;i++)n.set(s,i,Math.min(t.get(s,i),r.get(s,i)));return n}},{key:"max",value:function(t,r){t=this.checkMatrix(t),r=this.checkMatrix(r);for(var e=t.rows,o=t.columns,n=new this(e,o),s=0;s<e;s++)for(var i=0;i<o;i++)n.set(s,i,Math.max(t.get(s,i),r.get(s,i)));return n}},{key:"checkMatrix",value:function(t){return r.isMatrix(t)?t:new U(t)}},{key:"isMatrix",value:function(t){return null!=t&&"Matrix"===t.klass}}]),r}();function B(t,r){return t-r}J.prototype.klass="Matrix","undefined"!=typeof Symbol&&(J.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return w(this)}),J.random=J.rand,J.randomInt=J.randInt,J.diagonal=J.diag,J.prototype.diagonal=J.prototype.diag,J.identity=J.eye,J.prototype.negate=J.prototype.neg,J.prototype.tensorProduct=J.prototype.kroneckerProduct;var U=function(t){r(i,J);var e=O(i);function i(t,r){var s;if(n(this,i),s=e.call(this),i.isMatrix(t))return o(s,t.clone());if(Number.isInteger(t)&&t>=0){if(s.data=[],!(Number.isInteger(r)&&r>=0))throw new TypeError("nColumns must be a positive integer");for(var u=0;u<t;u++)s.data.push(new Float64Array(r))}else{if(!Array.isArray(t))throw new TypeError("First argument must be a positive number or an array");var a=t;if("number"!=typeof(r=(t=a.length)?a[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");s.data=[];for(var h=0;h<t;h++){if(a[h].length!==r)throw new RangeError("Inconsistent array dimensions");s.data.push(Float64Array.from(a[h]))}}return s.rows=t,s.columns=r,s}return s(i,[{key:"set",value:function(t,r,e){return this.data[t][r]=e,this}},{key:"get",value:function(t,r){return this.data[t][r]}},{key:"removeRow",value:function(t){return y(this,t),this.data.splice(t,1),this.rows-=1,this}},{key:"addRow",value:function(t,r){return void 0===r&&(r=t,t=this.rows),y(this,t,!0),r=Float64Array.from(b(this,r)),this.data.splice(t,0,r),this.rows+=1,this}},{key:"removeColumn",value:function(t){d(this,t);for(var r=0;r<this.rows;r++){for(var e=new Float64Array(this.columns-1),o=0;o<t;o++)e[o]=this.data[r][o];for(var n=t+1;n<this.columns;n++)e[n-1]=this.data[r][n];this.data[r]=e}return this.columns-=1,this}},{key:"addColumn",value:function(t,r){void 0===r&&(r=t,t=this.columns),d(this,t,!0),r=M(this,r);for(var e=0;e<this.rows;e++){for(var o=new Float64Array(this.columns+1),n=0;n<t;n++)o[n]=this.data[e][n];for(o[n++]=r[e];n<this.columns+1;n++)o[n]=this.data[e][n-1];this.data[e]=o}return this.columns+=1,this}}]),i}();!function(t,r){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)+t);return this},t.prototype.addM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)+t.get(e,o));return this},t.add=function(t,e){return new r(t).add(e)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)-t);return this},t.prototype.subM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)-t.get(e,o));return this},t.sub=function(t,e){return new r(t).sub(e)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)*t);return this},t.prototype.mulM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)*t.get(e,o));return this},t.mul=function(t,e){return new r(t).mul(e)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)/t);return this},t.prototype.divM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)/t.get(e,o));return this},t.div=function(t,e){return new r(t).div(e)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)%t);return this},t.prototype.modM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)%t.get(e,o));return this},t.mod=function(t,e){return new r(t).mod(e)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)&t);return this},t.prototype.andM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)&t.get(e,o));return this},t.and=function(t,e){return new r(t).and(e)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)|t);return this},t.prototype.orM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)|t.get(e,o));return this},t.or=function(t,e){return new r(t).or(e)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)^t);return this},t.prototype.xorM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)^t.get(e,o));return this},t.xor=function(t,e){return new r(t).xor(e)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)<<t);return this},t.prototype.leftShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)<<t.get(e,o));return this},t.leftShift=function(t,e){return new r(t).leftShift(e)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)>>t.get(e,o));return this},t.signPropagatingRightShift=function(t,e){return new r(t).signPropagatingRightShift(e)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,this.get(r,e)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,this.get(e,o)>>>t.get(e,o));return this},t.rightShift=function(t,e){return new r(t).rightShift(e)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,~this.get(t,r));return this},t.not=function(t){return new r(t).not()},t.prototype.abs=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.abs(this.get(t,r)));return this},t.abs=function(t){return new r(t).abs()},t.prototype.acos=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.acos(this.get(t,r)));return this},t.acos=function(t){return new r(t).acos()},t.prototype.acosh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.acosh(this.get(t,r)));return this},t.acosh=function(t){return new r(t).acosh()},t.prototype.asin=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.asin(this.get(t,r)));return this},t.asin=function(t){return new r(t).asin()},t.prototype.asinh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.asinh(this.get(t,r)));return this},t.asinh=function(t){return new r(t).asinh()},t.prototype.atan=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.atan(this.get(t,r)));return this},t.atan=function(t){return new r(t).atan()},t.prototype.atanh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.atanh(this.get(t,r)));return this},t.atanh=function(t){return new r(t).atanh()},t.prototype.cbrt=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.cbrt(this.get(t,r)));return this},t.cbrt=function(t){return new r(t).cbrt()},t.prototype.ceil=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.ceil(this.get(t,r)));return this},t.ceil=function(t){return new r(t).ceil()},t.prototype.clz32=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.clz32(this.get(t,r)));return this},t.clz32=function(t){return new r(t).clz32()},t.prototype.cos=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.cos(this.get(t,r)));return this},t.cos=function(t){return new r(t).cos()},t.prototype.cosh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.cosh(this.get(t,r)));return this},t.cosh=function(t){return new r(t).cosh()},t.prototype.exp=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.exp(this.get(t,r)));return this},t.exp=function(t){return new r(t).exp()},t.prototype.expm1=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.expm1(this.get(t,r)));return this},t.expm1=function(t){return new r(t).expm1()},t.prototype.floor=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.floor(this.get(t,r)));return this},t.floor=function(t){return new r(t).floor()},t.prototype.fround=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.fround(this.get(t,r)));return this},t.fround=function(t){return new r(t).fround()},t.prototype.log=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log(this.get(t,r)));return this},t.log=function(t){return new r(t).log()},t.prototype.log1p=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log1p(this.get(t,r)));return this},t.log1p=function(t){return new r(t).log1p()},t.prototype.log10=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log10(this.get(t,r)));return this},t.log10=function(t){return new r(t).log10()},t.prototype.log2=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.log2(this.get(t,r)));return this},t.log2=function(t){return new r(t).log2()},t.prototype.round=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.round(this.get(t,r)));return this},t.round=function(t){return new r(t).round()},t.prototype.sign=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sign(this.get(t,r)));return this},t.sign=function(t){return new r(t).sign()},t.prototype.sin=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sin(this.get(t,r)));return this},t.sin=function(t){return new r(t).sin()},t.prototype.sinh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sinh(this.get(t,r)));return this},t.sinh=function(t){return new r(t).sinh()},t.prototype.sqrt=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.sqrt(this.get(t,r)));return this},t.sqrt=function(t){return new r(t).sqrt()},t.prototype.tan=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.tan(this.get(t,r)));return this},t.tan=function(t){return new r(t).tan()},t.prototype.tanh=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.tanh(this.get(t,r)));return this},t.tanh=function(t){return new r(t).tanh()},t.prototype.trunc=function(){for(var t=0;t<this.rows;t++)for(var r=0;r<this.columns;r++)this.set(t,r,Math.trunc(this.get(t,r)));return this},t.trunc=function(t){return new r(t).trunc()},t.pow=function(t,e){return new r(t).pow(e)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(var r=0;r<this.rows;r++)for(var e=0;e<this.columns;e++)this.set(r,e,Math.pow(this.get(r,e),t));return this},t.prototype.powM=function(t){if(t=r.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(var e=0;e<this.rows;e++)for(var o=0;o<this.columns;o++)this.set(e,o,Math.pow(this.get(e,o),t.get(e,o)));return this}}(J,U);var K=i.mark(G);function L(t,r){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,r){if(!t)return;if("string"==typeof t)return W(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return W(t,r)}(t))||r&&t&&"number"==typeof t.length){e&&(t=e);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){u=!0,s=t},f:function(){try{i||null==e.return||e.return()}finally{if(u)throw s}}}}function W(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,o=new Array(r);e<r;e++)o[e]=t[e];return o}var X=function(){function t(r){n(this,t);var e=r.number_epochs,o=void 0===e?5e3:e,s=r.batch_size,i=void 0===s?void 0:s,u=r.learning_rate,a=void 0===u?1e-4:u,h=r.weights,c=void 0===h?void 0:h;this.number_epochs=o,this.batch_size=i,this.learning_rate=a,this.weights=c?U.checkMatrix(c):void 0}return s(t,[{key:"toJSON",value:function(t){return{number_epochs:this.number_epochs,batch_size:this.batch_size,learning_rate:this.learning_rate,weights:this.weights}}},{key:"train",value:function(t,r){var e,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=U.checkMatrix(t),r=U.checkMatrix(r);for(var n=null!==(e=this.weights)&&void 0!==e?e:U.zeros(1+t.columns,1),s=0;s<this.number_epochs;s++){var i,u,a=0,h=L(G(t.rows,null!==(i=this.batch_size)&&void 0!==i?i:t.rows));try{for(h.s();!(u=h.n()).done;){var c=u.value,f=t.subMatrixRow(c),l=r.subMatrixRow(c),m=this.predict(f,n),v=m.sub(l),w=f.clone().addColumn(0,U.ones(f.rows,1)),p=U.columnVector(w.mulColumnVector(v).transpose().mean("row"));n=n.add(p.mul(this.learning_rate)),a+=v.pow(2).transpose().mmul(U.ones(v.rows,1)).get(0,0)}}catch(t){h.e(t)}finally{h.f()}o||console.log("Epoch: ".concat(s,"/").concat(this.number_epochs,"; MSE: ").concat(a/t.rows))}this.weights=n,o||console.log("Final weights: ".concat(n))}},{key:"predict",value:function(t,r){var e=(t=U.checkMatrix(t)).clone().addColumn(0,U.ones(t.rows,1));return U.add(e.mmul(null!=r?r:this.weights).exp(),1).pow(-1).mul(6).sub(3)}}]),t}();function $(t){return function(t){for(var r,e=t.length;0!==e;){r=Math.floor(Math.random()*e),e--;var o=[t[r],t[e]];t[e]=o[0],t[r]=o[1]}return t}(u(Array(t).keys()))}function G(t,r){var e;return i.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e=$(t);case 1:if(!(e.length>0)){o.next=6;break}return o.next=4,e.splice(0,r);case 4:o.next=1;break;case 6:case"end":return o.stop()}}),K)}var H=U.columnVector([7.93,-.195,-4.6,-.0116]),Q=function(){function t(r){n(this,t);var e=r.prep_data,o=void 0===e?[]:e,s=r.data,i=void 0===s?[]:s,u=r.model,a=void 0===u?{weights:H}:u;this._prep_data=o,this._data=i,this._model=new X(a)}return s(t,[{key:"stringify",value:function(){return JSON.stringify(this)}},{key:"toJSON",value:function(t){return{prep_data:this._prep_data,data:this._data,model:this._model}}},{key:"status",value:function(){return{initialized:0!==this._prep_data.length||0!==this._data.length,model:this._model,nbr_prep_data:this._prep_data.length,nbr_data:this._data.length}}},{key:"reset",value:function(t){this._data=[],this._model.weights=H.add(U.columnVector([t,0,0,0])),this._prep_data=[];for(var r=-5;r<=40;r+=15)for(var e=.2;e<=1.5;e+=.3)for(var o=-40;o<=180;o+=50){var n=this.predict(r,e,o);this._prep_data.push([r,e,o,n])}}},{key:"update",value:function(){var t=this._prep_data.concat(this._data),r=t.map((function(t){return t.slice(0,-1)})),e=t.map((function(t){return t.slice(-1)}));this._model.train(r,e)}},{key:"feedback",value:function(t,r,e,o){function n(o,n,s){return Math.pow(t-o,2)+Math.pow(r-n,2)+Math.pow(e-s,2)}if(this._data.push([t,r,e,o]),this._prep_data.length>0){var s=this._prep_data.reduce((function(t,r,e){var o=n.apply(void 0,u(r));return o<t.distance?{index:e,distance:o}:t}),{index:-1,distance:Number.MAX_VALUE});this._prep_data.splice(s.index,1)}this.update()}},{key:"predict",value:function(t,r,e){return this._model.predict([[t,r,e]]).get(0,0)}}]),t}();importScripts("https://unpkg.com/comlink@4.3.1/dist/umd/comlink.js"),Comlink.expose(Q);
