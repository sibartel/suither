import{i as e,d as t,e as r,f as n,g as a,c as s,h as i,a as o,b as u,r as c}from"./createClass.b7fe6e8e.js";import{i as l,s as f,S as p,a5 as d,k as h,l as v,n as m,a6 as y,y as g,p as w,C as b,f as _,h as k,j as x,v as O,w as E,x as j,o as S,A as P,O as R,_ as T,r as A,P as M,t as z,b as L,$ as C,Z as N,a7 as I}from"./client.3d5384e5.js";function $(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function D(t,r,n){return(D=$()?Reflect.construct:function(t,r,n){var a=[null];a.push.apply(a,r);var s=new(Function.bind.apply(t,a));return n&&e(s,n.prototype),s}).apply(null,arguments)}function W(e,r){var n;if(/^(#|rgb|hsl|currentColor)/.test(r))return e.style.color=r,!1;if(r.startsWith("--"))return e.style.color="var(".concat(r,")"),!1;var a=function(e){return e.split(" ").map((function(e){return/^(lighten|darken|accent)-/.test(e)?"text-".concat(e):"".concat(e,"-text")}))}(r);return(n=e.classList).add.apply(n,t(a)),a}var B=function(e,r){var n;return"string"==typeof r&&(n=W(e,r)),{update:function(r){var a;n?(a=e.classList).remove.apply(a,t(n)):e.style.color=null;"string"==typeof r&&(n=W(e,r))}}};function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=n(e);if(t){var i=n(this).constructor;r=Reflect.construct(s,arguments,i)}else r=s.apply(this,arguments);return a(this,r)}}function U(e){for(var t,r=[{class:"underlay"},e[9],{"stroke-dashoffset":"0"}],n={},a=0;a<r.length;a+=1)n=_(n,r[a]);return{c:function(){t=d("circle"),this.h()},l:function(e){t=h(e,"circle",{class:!0,"stroke-dashoffset":!0},1),v(t).forEach(m),this.h()},h:function(){y(t,n),g(t,"svelte-1hzfw0g",!0)},m:function(e,r){w(e,t,r)},p:function(e,a){y(t,n=b(r,[{class:"underlay"},e[9],{"stroke-dashoffset":"0"}])),g(t,"svelte-1hzfw0g",!0)},d:function(e){e&&m(t)}}}function G(e){for(var t,r,n,a,s,i,o,u,c,l,f,p=!e[1]&&U(e),C=[{class:"overlay"},e[9],{"stroke-dashoffset":e[8]}],N={},I=0;I<C.length;I+=1)N=_(N,C[I]);var $=e[12].default,D=k($,e,e[11],null);return{c:function(){t=x("div"),r=d("svg"),p&&p.c(),n=d("circle"),a=O(),s=x("div"),D&&D.c(),this.h()},l:function(e){t=h(e,"DIV",{role:!0,"aria-valuemin":!0,"aria-valuemax":!0,"aria-valuenow":!0,class:!0,style:!0});var i=v(t);r=h(i,"svg",{xmlns:!0,viewBox:!0,style:!0,class:!0},1);var o=v(r);p&&p.l(o),n=h(o,"circle",{class:!0,"stroke-dashoffset":!0},1),v(n).forEach(m),o.forEach(m),a=E(i),s=h(i,"DIV",{class:!0});var u=v(s);D&&D.l(u),u.forEach(m),i.forEach(m),this.h()},h:function(){y(n,N),g(n,"svelte-1hzfw0g",!0),j(r,"xmlns","http://www.w3.org/2000/svg"),j(r,"viewBox",e[7]+"\n    "+e[7]+"\n    "+2*e[7]+"\n    "+2*e[7]),S(r,"transform","rotate("+e[3]+"deg)"),j(r,"class","svelte-1hzfw0g"),j(s,"class","s-progress-circular__content svelte-1hzfw0g"),j(t,"role","progressbar"),j(t,"aria-valuemin","0"),j(t,"aria-valuemax","100"),j(t,"aria-valuenow",e[5]),j(t,"class",i="s-progress-circular "+e[0]+" svelte-1hzfw0g"),j(t,"style",o="width:"+e[4]+"px;height:"+e[4]+"px;"+e[6]),g(t,"indeterminate",e[1])},m:function(i,o){w(i,t,o),P(t,r),p&&p.m(r,null),P(r,n),P(t,a),P(t,s),D&&D.m(s,null),c=!0,l||(f=R(u=B.call(null,t,e[2])),l=!0)},p:function(e,a){var s=T(a,1)[0];e[1]?p&&(p.d(1),p=null):p?p.p(e,s):((p=U(e)).c(),p.m(r,n)),y(n,N=b(C,[{class:"overlay"},e[9],{"stroke-dashoffset":e[8]}])),g(n,"svelte-1hzfw0g",!0),(!c||8&s)&&S(r,"transform","rotate("+e[3]+"deg)"),D&&D.p&&(!c||2048&s)&&A(D,$,e,e[11],s,null,null),(!c||32&s)&&j(t,"aria-valuenow",e[5]),(!c||1&s&&i!==(i="s-progress-circular "+e[0]+" svelte-1hzfw0g"))&&j(t,"class",i),(!c||80&s&&o!==(o="width:"+e[4]+"px;height:"+e[4]+"px;"+e[6]))&&j(t,"style",o),u&&M(u.update)&&4&s&&u.update.call(null,e[2]),3&s&&g(t,"indeterminate",e[1])},i:function(e){c||(z(D,e),c=!0)},o:function(e){L(D,e),c=!1},d:function(e){e&&m(t),p&&p.d(),D&&D.d(e),l=!1,f()}}}function F(e,t,r){var n=t.$$slots,a=void 0===n?{}:n,s=t.$$scope,i=t.class,o=void 0===i?"":i,u=t.indeterminate,c=void 0!==u&&u,l=t.color,f=void 0===l?"secondary":l,p=t.rotate,d=void 0===p?0:p,h=t.size,v=void 0===h?32:h,m=t.value,y=void 0===m?0:m,g=t.width,w=void 0===g?4:g,b=t.style,_=void 0===b?"":b,k=125.664,x=20/(1-Number(w)/+v),O=Number(w)/+v*x*2,E=(100-y)/100*k,j={fill:"transparent",cx:2*x,cy:2*x,r:20,"stroke-width":O,"stroke-dasharray":k};return e.$$set=function(e){"class"in e&&r(0,o=e.class),"indeterminate"in e&&r(1,c=e.indeterminate),"color"in e&&r(2,f=e.color),"rotate"in e&&r(3,d=e.rotate),"size"in e&&r(4,v=e.size),"value"in e&&r(5,y=e.value),"width"in e&&r(10,w=e.width),"style"in e&&r(6,_=e.style),"$$scope"in e&&r(11,s=e.$$scope)},[o,c,f,d,v,y,_,x,E,j,w,s,a]}var V=function(e){r(n,p);var t=H(n);function n(e){var r;return s(this,n),r=t.call(this),l(i(r),e,F,G,f,{class:0,indeterminate:1,color:2,rotate:3,size:4,value:5,width:10,style:6}),r}return n}();function Y(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,s=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw s}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Z=Symbol("Comlink.proxy"),q=Symbol("Comlink.endpoint"),K=Symbol("Comlink.releaseProxy"),Q=Symbol("Comlink.thrown"),ee=function(e){return"object"===o(e)&&null!==e||"function"==typeof e},te=new Map([["proxy",{canHandle:function(e){return ee(e)&&e[Z]},serialize:function(e){var t=new MessageChannel,r=t.port1,n=t.port2;return re(e,r),[n,[n]]},deserialize:function(e){return e.start(),ae(e)}}],["throw",{canHandle:function(e){return ee(e)&&Q in e},serialize:function(e){var t=e.value;return[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]]},deserialize:function(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function re(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;r.addEventListener("message",(function n(a){if(a&&a.data){var s,i=Object.assign({path:[]},a.data),o=i.id,u=i.type,c=i.path,l=(a.data.argumentList||[]).map(pe);try{var f=c.slice(0,-1).reduce((function(e,t){return e[t]}),e),p=c.reduce((function(e,t){return e[t]}),e);switch(u){case"GET":s=p;break;case"SET":f[c.slice(-1)[0]]=pe(a.data.value),s=!0;break;case"APPLY":s=p.apply(f,l);break;case"CONSTRUCT":var d;s=le(D(p,t(l)));break;case"ENDPOINT":var h=new MessageChannel,v=h.port1,m=h.port2;re(e,m),s=ce(v,[v]);break;case"RELEASE":s=void 0;break;default:return}}catch(d){s=C({value:d},Q,0)}Promise.resolve(s).catch((function(e){return C({value:e},Q,0)})).then((function(e){var t=fe(e),a=T(t,2),s=a[0],i=a[1];r.postMessage(Object.assign(Object.assign({},s),{id:o}),i),"RELEASE"===u&&(r.removeEventListener("message",n),ne(r))}))}})),r.start&&r.start()}function ne(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function ae(e,t){return ie(e,[],t)}function se(e){if(e)throw new Error("Proxy has been released and is not useable")}function ie(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=!1,s=new Proxy(n,{get:function(n,i){if(se(a),i===K)return function(){return de(e,{type:"RELEASE",path:r.map((function(e){return e.toString()}))}).then((function(){ne(e),a=!0}))};if("then"===i){if(0===r.length)return{then:function(){return s}};var o=de(e,{type:"GET",path:r.map((function(e){return e.toString()}))}).then(pe);return o.then.bind(o)}return ie(e,[].concat(t(r),[i]))},set:function(n,s,i){se(a);var o=fe(i),u=T(o,2),c=u[0],l=u[1];return de(e,{type:"SET",path:[].concat(t(r),[s]).map((function(e){return e.toString()})),value:c},l).then(pe)},apply:function(t,n,s){se(a);var i=r[r.length-1];if(i===q)return de(e,{type:"ENDPOINT"}).then(pe);if("bind"===i)return ie(e,r.slice(0,-1));var o=oe(s),u=T(o,2),c=u[0],l=u[1];return de(e,{type:"APPLY",path:r.map((function(e){return e.toString()})),argumentList:c},l).then(pe)},construct:function(t,n){se(a);var s=oe(n),i=T(s,2),o=i[0],u=i[1];return de(e,{type:"CONSTRUCT",path:r.map((function(e){return e.toString()})),argumentList:o},u).then(pe)}});return s}function oe(e){var t,r=e.map(fe);return[r.map((function(e){return e[0]})),(t=r.map((function(e){return e[1]})),Array.prototype.concat.apply([],t))]}var ue=new WeakMap;function ce(e,t){return ue.set(e,t),e}function le(e){return Object.assign(e,C({},Z,!0))}function fe(e){var t,r=J(te);try{for(r.s();!(t=r.n()).done;){var n=T(t.value,2),a=n[0],s=n[1];if(s.canHandle(e)){var i=s.serialize(e),o=T(i,2);return[{type:"HANDLER",name:a,value:o[0]},o[1]]}}}catch(e){r.e(e)}finally{r.f()}return[{type:"RAW",value:e},ue.get(e)||[]]}function pe(e){switch(e.type){case"HANDLER":return te.get(e.name).deserialize(e.value);case"RAW":return e.value}}function de(e,t,r){return new Promise((function(n){var a=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===a&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),r)}))}var he=[{description:"Walking shorts, short-sleeved shirt",category:["sport","casual"],insulation:.36,file_identifier:"shortshort"},{description:"Walking shorts, short-sleeved shirt plus long-sleeve sweater",category:["sport","casual"],insulation:.36,file_identifier:"shortsweater",variants:[{description:"sweater on",insulation:.61}]},{description:"Walking shorts, long-sleeved shirt",category:["sport","casual"],insulation:.4,file_identifier:"shortlong"},{description:"Trousers, short-sleeved shirt",category:["sport","casual"],insulation:.57,file_identifier:"longshort"},{description:"Trousers, short-sleeved shirt plus sweater",category:["sport","casual"],insulation:.57,file_identifier:"longsweater",variants:[{description:"sweater on",insulation:.82}]},{description:"Trousers, short-sleeved shirt plus jacket",category:["sport","casual"],insulation:.57,file_identifier:"longjacket",variants:[{description:"jacket on",insulation:.92,waterproof:!0}]},{description:"Trousers, long-sleeved shirt",category:["sport","casual"],insulation:.61,file_identifier:"trouserslong"},{description:"Trousers, long-sleeved shirt plus sweater",category:["sport","casual"],insulation:.61,file_identifier:"longlongsweater",variants:[{description:"sweater on",insulation:.86}]},{description:"Trousers, long-sleeved shirt plus jacket",category:["sport","casual"],insulation:.61,file_identifier:"trouserslongjacket",variants:[{description:"jacket on",insulation:.96,waterproof:!0}]},{description:"Trousers, long-sleeved shirt, long-sleeved sweater, T-shirt",category:["casual"],insulation:1.01,file_identifier:"trouserslonglong"}],ve=["variants"];function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge=null,we=function(){function e(t){s(this,e),this.cloth_sets=t,this.user_model=null}var r,n,a,i,o,l,f,p;return u(e,[{key:"init",value:(p=N(c.mark((function e(){var t,r;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ae(new Worker(new URL("worker.915343bc.js",import.meta.url))),r={},"undefined"!=typeof localStorage&&localStorage.getItem("user_model")&&(r=JSON.parse(localStorage.getItem("user_model"))),e.next=5,new t(r);case 5:this.user_model=e.sent;case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"model_status",value:(f=N(c.mark((function e(){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.user_model.status();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"reset_model",value:(l=N(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.user_model.reset(t);case 2:return e.next=4,this.save_model();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"save_model",value:(o=N(c.mark((function e(){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof localStorage){e.next=6;break}return e.t0=localStorage,e.next=4,this.user_model.stringify();case 4:e.t1=e.sent,e.t0.setItem.call(e.t0,"user_model",e.t1);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"recommend",value:(i=N(c.mark((function e(){var r,n,a,s,i,o=this,u=arguments;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:8,n=u.length>1&&void 0!==u[1]?u[1]:60,a=u.length>2&&void 0!==u[2]?u[2]:null,s=u.length>3&&void 0!==u[3]&&u[3],e.next=6,I.get_weather_forecast();case 6:return i=e.sent.slice(0,r),e.next=9,Promise.all(this.cloth_sets.filter((function(e){return!a||e.category.includes(a)})).map(function(){var e=N(c.mark((function e(a){var u,l,f,p;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=a.variants,(l=Y(a,ve)).description="base",f=[l].concat(t(null!=u?u:[])),e.next=5,Promise.all(i.map(function(){var e=N(c.mark((function e(t){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(f.map(function(){var e=N(c.mark((function e(r){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ye,e.next=3,o.user_model.predict(t.feels_like,r.insulation,n);case 3:return e.t1=e.sent,e.t2=t.pop<.3||r.waterproof,e.t3={predicted_thermal_sensation:e.t1,precipitation_suitable:e.t2},e.t4=r,e.abrupt("return",(0,e.t0)(e.t3,e.t4));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent.reduce((function(e,t){if(!s){if(t.precipitation_suitable&&!e.precipitation_suitable)return t;if(e.precipitation_suitable&&!t.precipitation_suitable)return e}return Math.abs(e.predicted_thermal_sensation)<Math.abs(t.predicted_thermal_sensation)?e:t})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return p=e.sent,e.abrupt("return",ye({predicted_thermal_sensation:{hourly:p,max:Math.max.apply(Math,t(p.map((function(e){return e.predicted_thermal_sensation})))),min:Math.min.apply(Math,t(p.map((function(e){return e.predicted_thermal_sensation})))),mean:p.map((function(e){return e.predicted_thermal_sensation})).reduce((function(e,t){return e+t}),0)/r,mse:p.map((function(e){return e.predicted_thermal_sensation})).reduce((function(e,t){return e+Math.pow(t,2)}),0)/r},precipitation_suitable:p.every((function(e){return e.precipitation_suitable}))},a));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:return e.abrupt("return",e.sent.filter((function(e){return s||e.precipitation_suitable})).sort((function(e,t){return Math.abs(e.predicted_thermal_sensation.mse)>Math.abs(t.predicted_thermal_sensation.mse)?1:-1})));case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"feedback",value:(a=N(c.mark((function e(t,r,n,a){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.user_model.feedback(t,r,n,a);case 2:return e.next=4,this.save_model();case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"live_feedback",value:(n=N(c.mark((function e(t,r,n){var a;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.get_weather_current().feels_like;case 2:return a=e.sent,e.next=5,this.user_model.feedback(a,t,r,n);case 5:return e.next=7,this.save_model();case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}],[{key:"get_categories",value:function(){return t(new Set(he.map((function(e){return e.category})).flat()))}},{key:"get",value:(r=N(c.mark((function t(){var r;return c.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(ge){t.next=7;break}if("undefined"!=typeof Worker){t.next=3;break}throw new Error("Web worker not supported in current renderer.");case 3:return r=new e(he),t.next=6,r.init();case 6:ge=r;case 7:return t.abrupt("return",ge);case 8:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}]),e}();export{V as P,we as R,B as T};
